cleanomarchy() {

    LOGFILE="$HOME/.cleanomarchy.log"

    echo -e "\n‚ú® Omarchy Clean ‚Äî Safe Mode"
    echo "Log file: $LOGFILE"
    echo "------------------------------------------" | tee -a "$LOGFILE"

    {
        echo -e "\nüìä Disk usage BEFORE:"
        df -h /

        ############################################
        # 1Ô∏è‚É£ Ensure paccache exists
        ############################################
        if ! command -v paccache >/dev/null 2>&1; then
            echo "Installing pacman-contrib (safe cache management)..."
            sudo pacman -Sy --needed pacman-contrib
        fi

        echo -e "\nüì¶ Trimming pacman cache (keeping last 2 versions)..."
        sudo paccache -r -k 2

        ############################################
        # 2Ô∏è‚É£ Remove leftover pacman download dirs
        ############################################
        sudo find /var/cache/pacman/pkg/ -type d -name "download-*" -empty -delete 2>/dev/null

        ############################################
        # 3Ô∏è‚É£ Dependency integrity check
        ############################################
        echo -e "\nüîé Checking dependency integrity..."
        pacman -Dk || true

        ############################################
        # 4Ô∏è‚É£ Orphan review (interactive)
        ############################################
        echo -e "\nüëª Checking for orphan packages..."
        ORPHANS=$(pacman -Qdtq)

        if [ -n "$ORPHANS" ]; then
            echo "$ORPHANS" | tee -a "$LOGFILE"
            read "confirm?Remove these orphans? (y/N): " < /dev/tty
            echo
            if [[ "$confirm" == "y" ]]; then
                sudo pacman -Rns -- $ORPHANS
                echo "‚úÖ Orphans removed."
            else
                echo "Skipped orphan removal."
            fi
        else
            echo "No orphaned packages found."
        fi

        ############################################
        # 5Ô∏è‚É£ Journal cleanup
        ############################################
        echo -e "\nü™µ Trimming journal logs (max 200MB)..."
        sudo journalctl --vacuum-size=200M

        ############################################
        # 6Ô∏è‚É£ User cache cleanup
        ############################################
        echo -e "\nüóë Cleaning user cache..."
        rm -rf "$HOME/.cache/"* 2>/dev/null
        rm -rf "$HOME/.local/share/Trash/"* 2>/dev/null
        rm -rf "$HOME/.cache/thumbnails/"* 2>/dev/null

        ############################################
        # 7Ô∏è‚É£ Hyprland temp cache (only if not running)
        ############################################
        if [[ -z "${HYPRLAND_INSTANCE_SIGNATURE:-}" ]]; then
            echo "Cleaning Hyprland temp cache..."
            rm -rf "$HOME/.cache/hyprland/"* 2>/dev/null
            rm -rf /tmp/hypr/* 2>/dev/null
        else
            echo "Hyprland session detected ‚Äî skipping live cache cleanup."
        fi

        ############################################
        # 8Ô∏è‚É£ AUR cache cleanup
        ############################################
        if command -v yay >/dev/null 2>&1; then
            echo -e "\nüîß Cleaning yay cache..."
            yay -Sc --noconfirm
        fi

        ############################################
        # 9Ô∏è‚É£ Flatpak cleanup
        ############################################
        if command -v flatpak >/dev/null 2>&1; then
            echo -e "\nüì¶ Removing unused Flatpaks..."
            flatpak uninstall --unused -y
        fi

        ############################################
        # üîü Broken symlink sweep
        ############################################
        echo -e "\nüîó Removing broken symlinks in HOME..."
        find "$HOME" -xtype l -delete 2>/dev/null

        ############################################
        # Final Report
        ############################################
        echo -e "\nüìä Disk usage AFTER:"
        df -h /

        echo -e "\n‚ú® Omarchy Clean Complete ‚Äî System Stable & Lean"
        echo "------------------------------------------"

    } | tee -a "$LOGFILE"
}